angular.module("easyRuta",["ui.router","ngMaterial","ngMaterialDatePicker","ngMessages","ngMap","LocalStorageModule","ez-Data","ez-RealTime"]).constant("collectionsEnum",{role:"_Role",user:"_User",proveedorCarga:"ProveedorCarga",proveedorCargaRutas:"ProveedorCargaRutas",transportista:"Transportista",transportistaRutas:"transportistaRutas",chofer:"Chofer",pedido:"Pedido",broker:"Broker",notificacion:"Notificacion"}).constant("pedidoEstadosEnum",{pendiente:"Pendiente",activo:"Activo",enCurso:"EnCurso",finalizado:"Finalizado",cancelado:"Cancelado"}).constant("choferEstadosEnum",{disponible:"Disponible",enViaje:"EnViaje",deshabilitado:"Deshabilitado"}).constant("uiEventsEnum",{pedidosTabChanged:"pedidosTabChanged"}).constant("uiContextEnum",{proveedorCargaPedidos:"proveedorCargaPedidos"}).constant("rolesEnum",{proveedorCarga:"proveedorCarga",broker:"broker",transportista:"transportista",chofer:"chofer"}).constant("localStorageKeys",{role:"role",proveedorCarga:"proveedorCarga",broker:"broker",transportista:"transportista"}).constant("realtimeChannels",{pedidoCreado:"pedidoCreado",pedidoAsignado:"pedidoAsignado",pedidoIniciado:"pedidoIniciado",pedidoFinalizado:"pedidoFinalizado",pedidoCancelado:"pedidoCancelado"}),angular.module("easyRuta").config(["dataServiceProvider",function(a){a.initialize("wJjWR5KTriUoPNnDH3baAQMkWvpAhuFhNU7PsKOP","qpl5kH3ylsBswrTqljtlx8S6iOZgjH3o2rGDeLgG")}]),angular.module("easyRuta").config(["localStorageServiceProvider",function(a){a.setPrefix("easyRuta").setStorageType("sessionStorage")}]),angular.module("easyRuta").config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("blue-grey").accentPalette("amber")}]).config(["$mdThemingProvider",function(a){a.theme("dark").dark()}]);var createBoundedWrapper=function(a,b){return function(){return b.apply(a,arguments)}};angular.module("easyRuta").config(["realtimeServiceProvider",function(a){var b=PUBNUB.db.get("session")||function(){var a=PUBNUB.uuid();return PUBNUB.db.set("session",a),a}();a.initialize("pub-c-dbd199d2-5422-4ef9-95ac-5565e99d8036","sub-c-5fda96b4-7848-11e5-b539-0619f8945a4f",b)}]).run(["$rootScope","realtimeService","realtimeChannels",function(a,b,d){for(c in d){var e={channel:c,presence:function(c){c.uuid!=b.uuid&&a.$broadcast("presense_"+this.channel,c)},message:function(c){c.uuid!=b.uuid&&a.$broadcast(this.channel,c)}};e.presence=createBoundedWrapper(e,e.presence),e.message=createBoundedWrapper(e,e.message),b.pubnub.subscribe(e)}}]),angular.module("easyRuta").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/home"),a.state("public",{url:"/home",templateUrl:"/app/components/shared/home/homeView.html"}).state("private",{url:"/main",templateUrl:"/app/components/shared/master/masterView.html"}).state("private.proveedorCarga",{url:"/proveedorCarga",templateUrl:"/app/components/proveedorCarga/pedidos/proveedorCargaPedidosView.html"}).state("private.transportista",{url:"/transportista",templateUrl:"/app/components/transportista/pedidos/transportistaPedidosView.html"}).state("private.proveedorCarga-pedidos",{url:"/proveedorCarga/pedidos",templateUrl:"/app/components/proveedorCarga/pedidos/proveedorCargaPedidosView.html"}).state("private.transportista-pedidos",{url:"/transportista/pedidos",templateUrl:"/app/components/transportista/pedidos/transportistaPedidosView.html"}).state("private.transportista-flota",{url:"/transportista/flota",templateUrl:"/app/components/transportista/flota/transportistaFlotaView.html"})}]).run(["$rootScope","dataService","$location","localStorageService","localStorageKeys",function(a,b,c,d,e){var f=function(){!b.currentUser()&&c.path().indexOf("/main")>=0||b.currentUser()&&(a.role||(a.role=JSON.parse(d.get(e.role)),a.proveedorCarga=JSON.parse(d.get(e.proveedorCarga)),a.transportista=JSON.parse(d.get(e.transportista)),a.broker=JSON.parse(d.get(e.broker)),a.role||(c.path("/home"),c.replace())))};a.$on("$stateChangeStart",function(a,b,c,d,e,g){f()}),f()}]),angular.module("easyRuta").controller("proveedorCargaPedidosController",["$rootScope","$scope","uiEventsEnum","uiContextEnum","proveedorCargaPedidosService","pedidoEstadosEnum","$mdDialog","realtimeChannels","$mdToast","$http","NgMap",function(a,b,c,d,e,f,g,h,i,j,k){b.pedidosPendientes=[],b.pedidosEnProceso=[],b.pedidosCompletados=[],b.selectedTabIndex=0,b.showSetTransportista=!1,b.showCancelPedido=!0;var l=function(a,b){var c="https://roads.googleapis.com/v1/snapToRoads?path="+b.join("|")+"&interpolate=true&key=AIzaSyA7ImiLb8lU9DyK0_D-NFFp3zp4ffXL9r0";j({method:"GET",url:c}).then(function(b){m(a,b.data)},function(a){console.dir(a)})},m=function(a,b){for(var c=[],d=[],e=0;e<b.snappedPoints.length;e++){var f=new google.maps.LatLng(b.snappedPoints[e].location.latitude,b.snappedPoints[e].location.longitude);c.push(f),d.push(b.snappedPoints[e].placeId)}n(a,c,d)},n=function(a,b,c){var d=[],e=new google.maps.Polyline({path:b,strokeColor:"#1EB2E9",strokeWeight:4});e.setMap(a),d.push(e)},o=function(){b.pedidosEnProceso.forEach(function(a,b,c){a.estado==f.enCurso&&a.currentLocation&&k.getMap(a.id).then(function(b){var c=b,d="assets/images/truck.png",e=new google.maps.Marker({position:{lat:Number(a.currentLocation[0]),lng:Number(a.currentLocation[1])},map:c,icon:d});e.setMap(c),l(c,a.locations)})})},p=function(){e.getPedidos().subscribe(function(a){a=a.map(function(a){if(a.donacion)a.cssClass="pedido-donacion";else switch(a.estado){case f.pendiente:a.cssClass="pedido-pendientes";break;case f.activo:a.cssClass="pedido-activos";break;case f.enCurso:a.cssClass="pedido-en-curso";break;case f.finalizado:a.cssClass="pedido-completados"}return a}),b.pedidosPendientes=a.filter(function(a){return a.estado==f.pendiente}),b.pedidosEnProceso=a.filter(function(a){return a.estado==f.activo||a.estado==f.enCurso}),b.pedidosCompletados=a.filter(function(a){return a.estado==f.finalizado}),b.$apply(),o()},function(a){119==err.code?($location.path("/home"),$location.replace()):(console.dir(a),i.show(i.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)))},function(){})};b.addPedido=function(a,c){g.show({locals:{local:{donacion:!1,scope:b,pedido:c}},controller:"addPedidoController",templateUrl:"app/components/shared/pedidos/addPedido/addPedidoView.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){a&&(a.cssClass="pedido-pendientes",b.pedidosPendientes.push(a))})},b.addDonacion=function(a,c){g.show({locals:{local:{donacion:!0,scope:b,pedido:c}},controller:"addPedidoController",templateUrl:"app/components/shared/pedidos/addPedido/addPedidoView.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){a&&(a.cssClass="pedido-donacion",b.pedidosPendientes.push(a))})},b.cancelarPedido=function(a,c,d){var h=g.confirm().title("Estas seguro que quieres cancelar este pedido?").textContent("Esta accion es irreversible.").targetEvent(d).ok("Estoy seguro").cancel("Cancelar");g.show(h).then(function(){var d;c==f.pendiente?d=b.pedidosPendientes.find(function(b){return b.id==a}):c==f.activo&&(d=b.pedidosEnProceso.find(function(b){return b.id==a})),e.cancelarPedido(d).subscribe(function(a){c==f.pendiente?b.pedidosPendientes.splice(b.pedidosPendientes.indexOf(d),1):c==f.activo&&b.pedidosEnProceso.splice(b.pedidosEnProceso.indexOf(d),1),b.$apply()},function(a){console.dir(a),i.show(i.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3))},function(){})})},b.openMenu=function(a,b){a(b)},p(),b.$on(h.pedidoAsignado,function(a,b){p()}),b.$on(h.pedidoIniciado,function(a,b){p()}),b.$on(h.pedidoFinalizado,function(a,b){p()})}]),angular.module("easyRuta").service("proveedorCargaPedidosService",["collectionsEnum","dataService","pedidoModel","pedidoEstadosEnum","realtimeService","realtimeChannels","choferModel","choferEstadosEnum",function(a,b,c,d,e,f,g,h){return{getPedidos:function(){return Rx.Observable.create(function(d){var e=b.getAll(a.pedido,{filters:[{type:"and",operator:"=",field:"plantilla",value:void 0}],includes:["proveedorCarga","transportista","chofer"]}).subscribe(function(a){d.onNext(a.map(function(a){return c.toJson(a,[{field:"proveedorCarga"},{field:"transportista"},{field:"chofer"}])})),d.onCompleted()},function(a){d.onError(a)},function(){});return function(){e.dispose()}})},cancelarPedido:function(i){return Rx.Observable.create(function(j){var k=b.update(a.pedido,c.fromJson(i),{updatedFields:[{operator:"set",field:"estado",value:d.cancelado}]}).flatMap(function(c){var d=i.chofer;return i=c,d?b.update(a.chofer,g.fromJson(d),{updatedFields:[{operator:"set",field:"estado",value:h.disponible}]}):Rx.Observable.just(void 0)}).subscribe(function(a){e.publish(f.pedidoCancelado,{id:i.id}),j.onNext(c.toJson(i,[{field:"proveedorCarga"},{field:"transportista"},{field:"chofer"}])),j.onCompleted()},function(a){j.onError(a)},function(){});return function(){k.dispose()}})}}}]),angular.module("easyRuta").service("loginService",["$rootScope","localStorageService","dataService",function(a,b,c){return{login:function(d,e){return Rx.Observable.create(function(f){Parse.User.current()&&c.logout(),c.login(d,e).flatMap(function(a){return c.getAll("_Role",{filters:[{type:"and",operator:"=",field:"users",value:a}]})}).flatMap(function(d){switch(a.role={id:d[0].id,name:d[0].getName()},b.set("role",JSON.stringify(a.role)),d[0].getName()){case"proveedorCarga":return c.getAll("ProveedorCarga",{filters:[{type:"and",operator:"=",field:"user",value:c.currentUser()}]}).flatMap(function(c){return a.proveedorCarga={id:c[0].id},b.set("proveedorCarga",JSON.stringify(a.proveedorCarga)),Rx.Observable.just("/main/proveedorCarga")});case"transportista":return c.getAll("Transportista",{filters:[{type:"and",operator:"=",field:"user",value:c.currentUser()}]}).flatMap(function(c){return a.transportista={id:c[0].id},b.set("transportista",JSON.stringify(a.transportista)),Rx.Observable.just("/main/transportista")})}}).subscribe(function(a){f.onNext(a)},function(a){f.onError(a)},function(){f.onCompleted()})})}}}]).service("registrarProveedorService",["$rootScope","localStorageService","dataService",function(a,b,c){return{registrar:function(d){return Rx.Observable.create(function(e){Parse.User.current()&&c.logout();var f,g;c.signup(d.email,d.email,d.password).flatMap(function(a){return f=a,c.getAll("_Role",{filters:[{type:"and",operator:"=",field:"name",value:"proveedorCarga"}]})}).flatMap(function(a){return g=a[0],g.getUsers().add(f),c.update("_Role",g,{})}).flatMap(function(a){var b={currentUser:!0,permissions:[{isRole:!0,role:"broker",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"chofer",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"proveedorCarga",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"transportista",id:void 0,allowRead:!0,allowWrite:!1}]},e=c.createCollection("ProveedorCarga");return e.set("nombre",d.nombre),e.set("telefono",d.telefono),e.set("contacto",d.contacto),e.set("asociadoConTodos",!0),e.set("user",f),c.add("ProveedorCarga",e,{acl:b})}).subscribe(function(c){a.role={id:g.id,name:g.getName()},b.set("role",JSON.stringify(a.role)),a.proveedorCarga={id:c.id},b.set("proveedorCarga",JSON.stringify(a.proveedorCarga)),e.onNext(c)},function(a){e.onError(a)},function(){e.onCompleted()})})}}}]).service("registrarTransportistaService",["$rootScope","localStorageService","dataService",function(a,b,c){return{registrar:function(d){return Rx.Observable.create(function(e){Parse.User.current()&&c.logout();var f,g;c.signup(d.email,d.email,d.password).flatMap(function(a){return f=a,c.getAll("_Role",{filters:[{type:"and",operator:"=",field:"name",value:"transportista"}]})}).flatMap(function(a){return g=a[0],g.getUsers().add(f),c.update("_Role",g,{})}).flatMap(function(a){var b={currentUser:!0,permissions:[{isRole:!0,role:"broker",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"chofer",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"proveedorCarga",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"transportista",id:void 0,allowRead:!0,allowWrite:!1}]},e=c.createCollection("Transportista");return e.set("nombre",d.nombre),e.set("saldo",1e3),e.set("saldoMinimo",0),e.set("user",f),c.add("Transportista",e,{acl:b})}).subscribe(function(c){a.role={id:g.id,name:g.getName()},b.set("role",JSON.stringify(a.role)),a.transportista={id:c.id},b.set("transportista",JSON.stringify(a.transportista)),e.onNext(c)},function(a){e.onError(a)},function(){e.onCompleted()})})}}}]).service("registrarChoferService",["dataService",function(a){return{registrar:function(b){return Rx.Observable.create(function(c){Parse.User.current()&&a.logout();var d,e;a.signup(b.email,b.email,b.password).flatMap(function(b){return d=b,a.getAll("_Role",{filters:[{type:"and",operator:"=",field:"name",value:"proveedorCarga"}]})}).flatMap(function(b){return e=b[0],e.getUsers().add(d),a.update("_Role",e,{})}).flatMap(function(c){var e={currentUser:!0,permissions:[{isRole:!0,role:"broker",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"chofer",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"proveedorCarga",id:void 0,allowRead:!0,allowWrite:!1},{isRole:!0,role:"transportista",id:void 0,allowRead:!0,allowWrite:!1}]},f=a.createCollection("ProveedorCarga");return f.set("nombre",b.nombre),f.set("telefono",b.telefono),f.set("contacto",b.contacto),f.set("asociadoConTodos",!0),f.set("user",d),a.add("ProveedorCarga",f,{acl:e})}).subscribe(function(a){c.onNext(a)},function(a){c.onError(a)},function(){c.onCompleted()})})}}}]).controller("homeController",["$scope","$location","$mdDialog",function(a,b,c){a.user={username:"",password:""},a.showError=!1,a.error="",a.processing=!1,a.login=function(a){c.show({controller:"LoginController",templateUrl:"app/components/shared/home/login.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){b.path(a)})},a.registroProveedorCarga=function(a){c.show({controller:"registroProveedorCargaController",templateUrl:"app/components/shared/home/registroProveedorCarga.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){b.path(a)})},a.registroTransportista=function(a){c.show({controller:"registroTransportistaController",templateUrl:"app/components/shared/home/registroTransportista.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){b.path(a)})},a.registroChofer=function(a){}}]).controller("registroProveedorCargaController",["$scope","registrarProveedorService","$mdDialog",function(a,b,c){a.proveedorCarga={},a.showError=!1,a.error="",a.processing=!1,a.registrar=function(){a.processing=!0,b.registrar(a.proveedorCarga).subscribe(function(b){a.processing=!1,c.hide("/main/proveedorCarga")},function(b){if(a.processing=!1,a.showError=!0,101==b.code)a.error="Usuario y/o clave incorrectos.",a.$apply();else if(125==b.code)a.error="Email es invalido.",a.$apply();else{if(202!=b.code)throw a.error="Servicio no disponible, contacte a soporte.",a.$apply(),b;a.error="Ya existe un usuario con ese email.",a.$apply()}},function(){})}}]).controller("registroTransportistaController",["$scope","registrarTransportistaService","$mdDialog",function(a,b,c){a.transportista={},a.showError=!1,a.error="",a.processing=!1,a.registrar=function(){a.processing=!0,b.registrar(a.transportista).subscribe(function(b){a.processing=!1,c.hide("/main/transportista")},function(b){if(a.processing=!1,a.showError=!0,101==b.code)a.error="Usuario y/o clave incorrectos.",a.$apply();else if(125==b.code)a.error="Email es invalido.",a.$apply();else{if(202!=b.code)throw a.error="Servicio no disponible, contacte a soporte.",a.$apply(),b;a.error="Ya existe un usuario con ese email.",a.$apply()}},function(){})}}]).controller("registroChoferController",["$scope","registrarChoferService","$mdDialog",function(a,b,c){b.chofer={},b.showError=!1,b.error="",b.processing=!1,b.registrar=function(){b.processing=!0,registrarChoferService.registrar(b.chofer).subscribe(function(a){b.processing=!1,c.hide(!0)},function(a){if(b.processing=!1,b.showError=!0,101!=a.code)throw b.error="Servicio no disponible, contacte a soporte.",b.$apply(),a;b.error="Usuario y/o clave incorrectos.",b.$apply()},function(){})}}]).controller("LoginController",["$scope","loginService","$mdDialog",function(a,b,c){a.user={username:"",password:""},a.showError=!1,a.error="",a.processing=!1,a.login=function(){a.processing=!0,b.login(a.user.username,a.user.password).subscribe(function(b){a.processing=!1,c.hide(b)},function(b){if(a.processing=!1,a.showError=!0,101!=b.code)throw a.error="Servicio no disponible, contacte a soporte.",a.$apply(),b;a.error="Usuario y/o clave incorrectos.",a.$apply()},function(){})}}]),angular.module("easyRuta").controller("headerController",["$scope","$location","dataService","$mdSidenav",function(a,b,c,d){a.logout=function(){c.logout().subscribe(function(){b.path("/home")},function(a){},function(){})},a.toggleLeft=function(){d("sidenav-left").toggle()}}]),angular.module("easyRuta").controller("sidenavController",["$rootScope","$scope","$location","$mdSidenav","rolesEnum",function(a,b,c,d,e){b.showInicio=!0,b.showPedidos=!0,b.showRutas=!0,b.showFlota=!0,b.disabledInicio=!1,b.disabledPedidos=!1,b.disabledRutas=!0,b.disabledFlota=!1,b.inicio=function(){switch(a.role.name){case e.proveedorCarga:c.path("/main/proveedorCarga"),d("sidenav-left").close();break;case e.transportista:c.path("/main/transportista"),d("sidenav-left").close()}},b.pedidos=function(){switch(a.role.name){case e.proveedorCarga:c.path("/main/proveedorCarga/pedidos"),d("sidenav-left").close();break;case e.transportista:c.path("/main/transportista/pedidos"),d("sidenav-left").close()}},b.rutas=function(){},b.flota=function(){switch(a.role.name){case e.proveedorCarga:break;case e.transportista:c.path("/main/transportista/flota"),d("sidenav-left").close()}},a.role&&a.role.name==e.proveedorCarga&&(b.disabledFlota=!0)}]),angular.module("easyRuta").controller("addPedidoController",["$rootScope","$scope","addPedidoService","rolesEnum","$mdDialog","$mdToast","pedidoModel","transportistaModel","local",function(a,b,c,d,e,f,g,h,i){b.showEmpresas=!1,b.showBroker=!1,b.processing=!1,b.processingForm=!0;var j=function(){a.role.name==d.proveedorCarga&&(b.showBroker=!0),a.role.name==d.broker&&(b.showEmpresas=!0);var c=new Date;b.minDate=new Date(c.getFullYear(),c.getMonth(),c.getDate()),b.maxDate=new Date(c.getFullYear(),c.getMonth()+1,c.getDate())},k=function(){return Rx.Observable.create(function(e){var f;return f=a.role.name==d.proveedorCarga?c.getEmpresaCurrentUser().subscribe(function(a){b.empresas=[],b.pedido.proveedorCarga=a,e.onNext(a),e.onCompleted()},function(a){e.onError(a)},function(){}):c.getEmpresas().subscribe(function(a){b.empresas=a,a.length>0&&(b.pedido.proveedorCarga=a[0]),e.onNext(b.pedido.proveedorCarga),e.onCompleted()},function(a){e.onError(a)},function(){}),function(){f.dispose()}})},l=function(a){return Rx.Observable.create(function(d){var e=c.getPlantillas(a).subscribe(function(a){b.selectablePlantillas=a,d.onNext(!0),d.onCompleted()},function(a){d.onError(a)},function(){});return function(){e.dispose()}})},m=function(e){return Rx.Observable.create(function(f){if(a.role.name==d.proveedorCarga&&e.asociados&&e.asociados.length>0){var g=[];c.getTransportistas(e).subscribe(function(a){g.push(a)},function(a){f.onError(a)},function(){b.transportistas=g,f.onNext(e),f.onCompleted()})}else e.asociadoConTodos||i.donacion?(b.pedido.managedByBroker=!1,f.onNext(e),f.onCompleted()):(b.pedido.managedByBroker=!0,f.onNext(e),f.onCompleted())})};b.plantillaSelected=function(){var a=b.selectablePlantillas.find(function(a){return a.id==b.selectablePlantilla});b.pedido=g.toJson(a.object,[{field:"proveedorCarga"}]),b.pedido.plantilla=void 0,b.pedido.object=void 0,b.saveAsPlantilla=!1,i.donacion&&(b.pedido.managedByBroker=!1,b.pedido.donacion=!0)},b.transportistaSelected=function(){var a=b.transportistas.find(function(a){return a.id==b.selectedTransportista});b.pedido.transportista=h.toJson(a.object)},b.guardarPedido=function(){var a=!0;b.saveAsPlantilla&&b.selectablePlantillas.find(function(a){return a.plantilla==b.pedido.plantilla})&&(a=!1,f.show(f.simple().textContent("Ya existe una plantilla con ese nombre por favor seecione uno diferente.").position("top right ").hideDelay(5e3))),a&&(b.processing=!0,c.guardarPedido(b.pedido,b.saveAsPlantilla,b.transportistas).subscribe(function(a){b.processing=!1,a.plantilla?(b.selectablePlantillas.push(a),b.pedido.plantilla=void 0,b.saveAsPlantilla=!1,b.$apply(),f.show(f.simple().textContent("La Plantilla fue guardada y esta lista para usarse.").position("bottom right ").hideDelay(5e3))):e.hide(a)},function(a){console.dir(a),f.show(f.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){}))},b.eliminarPlantilla=function(){var a=b.selectablePlantillas.find(function(a){return a.id==b.selectablePlantilla});a&&a.plantilla&&(b.processingEliminarPlantilla=!0,c.eliminarPlantilla(a).subscribe(function(a){b.processingEliminarPlantilla=!1,b.selectablePlantilla=void 0;var c=b.selectablePlantillas.find(function(b){return b.id==a.id}),d=b.selectablePlantillas.indexOf(c);d>=0&&b.selectablePlantillas.splice(d,1),b.$apply()},function(a){console.dir(a),f.show(f.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){}))},b.cerrar=function(){e.hide()},b.calculateValor=function(a){b.pedido.ciudadOrigen&&b.pedido.ciudadDestino&&b.pedido.peso},b.pedido=c.getDefaultPedido(i.pedido,i.donacion),b.dialog=i.scope.addDonacion,j(),k().flatMap(function(a){return m(a)}).flatMap(function(a){return l(a)}).subscribe(function(a){console.log("Finish loading form."),b.processingForm=!1,b.$apply()},function(a){console.dir(a),f.show(f.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)),e.hide()},function(){})}]),angular.module("easyRuta").service("addPedidoService",["$rootScope","collectionsEnum","proveedorCargaModel","pedidoModel","transportistaModel","dataService","realtimeService","pedidoEstadosEnum","rolesEnum","realtimeChannels",function(a,b,c,d,e,f,g,h,i,j){return{getEmpresaCurrentUser:function(){return Rx.Observable.create(function(d){var e=f.get(b.proveedorCarga,{id:a.proveedorCarga.id}).subscribe(function(a){d.onNext(c.toJson(a)),d.onCompleted()},function(a){d.onError(a)},function(){});return function(){e.dispose()}})},getEmpresas:function(){return Rx.Observable.create(function(a){var d=f.getAll(b.proveedorCarga,void 0).subscribe(function(b){a.onNext(b.map(function(a){return c.toJson(a)})),a.onCompleted()},function(b){a.onError(b)},function(){});return function(){d.dispose()}})},getPlantillas:function(a){return Rx.Observable.create(function(c){var e=f.getAll(b.pedido,{filters:[{type:"and",operator:"!=",field:"plantilla",value:void 0},{type:"and",operator:"=",field:"proveedorCarga",value:a.object}]}).subscribe(function(a){c.onNext(a.map(function(a){return d.toJson(a)})),c.onCompleted()},function(a){c.onError(a)},function(){});return function(){e.dispose()}})},getTransportistas:function(a){return Rx.Observable.create(function(c){var d=[];return a.asociados.forEach(function(a,g,h){var i=f.get(b.transportista,{id:a}).subscribe(function(a){c.onNext(e.toJson(a)),g==h.length-1&&c.onCompleted()},function(a){c.onError(a),g==h.length-1&&c.onCompleted()},function(){});d.push(i)}),function(){d.forEach(function(a,b,c){a.dispose()})}})},getDefaultPedido:function(a,b){return a?a:{donacion:b,managedByBroker:!1,valor:0}},guardarPedido:function(a,c,e){var k={currentUser:!0,permissions:[]};return c?(a.estado=void 0,a.horaCarga=void 0,a.horaEntrega=void 0):(a.plantilla=void 0,a.estado=h.pendiente,a.managedByBroker?k.permissions.push({isRole:!0,role:i.broker,id:void 0,allowRead:!0,allowWrite:!0}):a.proveedorCarga.asociadoConTodos||a.donacion?k.permissions.push({isRole:!0,role:i.transportista,id:void 0,allowRead:!0,allowWrite:!0}):a.transportista?k.permissions.push({isRole:!1,role:void 0,id:a.transportista.user,allowRead:!0,allowWrite:!0}):e&&e.forEach(function(a,b,c){k.permissions.push({isRole:!1,role:void 0,id:a.user,allowRead:!0,allowWrite:!0})})),a.horaCarga&&(a.horaCarga=a.horaCarga._d),a.horaEntrega&&(a.horaEntrega=a.horaEntrega._d),Rx.Observable.create(function(c){var e=f.add(b.pedido,d.fromJson(a),{acl:k}).subscribe(function(a){g.publish(j.pedidoCreado,{id:a.id,acl:k}),c.onNext(d.toJson(a)),c.onCompleted()},function(a){c.onError(a)},function(){});return function(){e.dispose()}})},eliminarPlantilla:function(a){return Rx.Observable.create(function(c){var e=f["delete"](b.pedido,a.object).subscribe(function(a){c.onNext(d.toJson(a)),c.onCompleted()},function(a){c.onError(a)},function(){});return function(){e.dispose()}})}}}]),angular.module("easyRuta").controller("setTransportistaController",["$rootScope","$scope","setTransportistaService","rolesEnum","$mdDialog","$mdToast","pedido","$location","pedidoEstadosEnum",function(a,b,c,d,e,f,g,h,i){b.processing=!1;var j=function(){return c.getChoferes(g)};b.seleccionarChofer=function(a){var d=b.choferes.find(function(b){return b.id==a});c.getPedido(g).flatMap(function(a){return c.seleccionarChofer(g,d)}).subscribe(function(a){e.hide(a)},function(a){if(console.dir(a),a.estado){var b=a,c="Este pedido ya fue tomado y no esta disponible.";b.estado==i.cancelado&&(c="Este pedido fue cancelado y ya no esta disponible."),f.show(f.simple().textContent(c).position("top left").hideDelay(5e3)),e.hide(b)}else f.show(f.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)),e.hide()},function(){})},b.verFlota=function(){h.path("/main/transportista/flota"),e.hide()},b.cerrar=function(){e.hide()},j().subscribe(function(a){b.choferes=a,b.$apply(),console.log("Finish loading form.")},function(a){console.dir(a),f.show(f.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)),e.hide()},function(){})}]),angular.module("easyRuta").service("setTransportistaService",["$rootScope","collectionsEnum","choferModel","dataService","pedidoEstadosEnum","pedidoModel","realtimeService","realtimeChannels","choferModel","choferEstadosEnum",function(b,c,d,e,f,g,h,j,d,k){return{getChoferes:function(b){return Rx.Observable.create(function(f){var g={filters:[{type:"and",operator:"!=",field:"deleted",value:!0},{type:"and",operator:"=",field:"estado",value:k.disponible}],includes:["transportista"]},h=e.getAll(c.chofer,g).subscribe(function(a){f.onNext(a.map(function(a){return d.toJson(a,[{field:"transportista"}])}).filter(function(a){return b.tipoCamion.indexOf(a.tipoCamion)>=0})),f.onCompleted()},function(b){f.onError(b),i==a.length-1&&f.onCompleted()},function(){});return function(){h.dispose()}})},getPedido:function(a,b){return Rx.Observable.create(function(b){var d=e.get(c.pedido,{id:a.id}).subscribe(function(a){pedidoJson=g.toJson(a),pedidoJson.estado==f.pendiente?(b.onNext(!0),b.onCompleted()):b.onError(pedidoJson)},function(a){b.onError(a)},function(){});return function(){d.dispose()}})},seleccionarChofer:function(a,b){var i=[{operator:"set",field:"estado",value:f.activo},{operator:"set",field:"transportista",value:b.transportista.object},{operator:"set",field:"chofer",value:b.object},{operator:"set",field:"horaAsignacion",value:new Date}],l={currentUser:!0,permissions:[{isRole:!1,role:void 0,id:a.proveedorCarga.user,allowRead:!0,allowWrite:!0},{isRole:!1,role:void 0,id:b.transportista.user,allowRead:!0,allowWrite:!0}]};return b.user&&l.permissions.push({isRole:!1,role:void 0,id:b.user,allowRead:!0,allowWrite:!0}),Rx.Observable.create(function(f){var m=e.update(c.pedido,g.fromJson(a),{updatedFields:i,acl:l}).flatMap(function(f){return a=f,e.update(c.chofer,d.fromJson(b),{updatedFields:[{operator:"set",field:"estado",value:k.enViaje}]})}).subscribe(function(b){h.publish(j.pedidoAsignado,{id:a.id,acl:l}),f.onNext(g.toJson(a,[{field:"proveedorCarga"},{field:"transportista"},{field:"chofer"}])),f.onCompleted()},function(a){f.onError(a)},function(){});return function(){m.dispose()}})}}}]),angular.module("easyRuta").controller("progressViewController",["$scope","text",function(a,b){a.text=b}]),angular.module("easyRuta").controller("addChoferController",["$scope","addChoferService","$mdDialog","$mdToast","chofer",function(a,b,c,d,e){a.guardarChofer=function(){a.processing=!0,e?b.updateChofer(a.chofer).subscribe(function(b){a.processing=!1,c.hide(b)},function(a){console.dir(a),d.show(d.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){}):b.addChofer(a.chofer).subscribe(function(b){a.processing=!1,c.hide(b)},function(a){console.dir(a),d.show(d.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){})},a.cerrar=function(){c.hide()},e?a.chofer=e:a.chofer={anio:2e3},b.getTransportistaCurrentUser().subscribe(function(b){a.chofer.transportista=b},function(a){console.dir(a),d.show(d.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){})}]),angular.module("easyRuta").service("addChoferService",["$rootScope","collectionsEnum","transportistaModel","choferModel","dataService","rolesEnum","choferEstadosEnum",function(a,b,c,d,e,f,g){return{getTransportistaCurrentUser:function(){return Rx.Observable.create(function(d){var f=e.get(b.transportista,{id:a.transportista.id}).subscribe(function(a){d.onNext(c.toJson(a)),d.onCompleted()},function(a){d.onError(a)},function(){});return function(){f.dispose()}})},addChofer:function(a){var c={currentUser:!0,permissions:[{isRole:!0,role:f.broker,id:void 0,allowRead:!0,allowWrite:!0},{isRole:!0,role:f.proveedorCarga,id:void 0,allowRead:!0,allowWrite:!0}]};return a.estado=g.disponible,Rx.Observable.create(function(f){var g=e.add(b.chofer,d.fromJson(a),{acl:c}).subscribe(function(a){f.onNext(d.toJson(a)),f.onCompleted()},function(a){f.onError(a)},function(){});return function(){g.dispose()}})},updateChofer:function(a){return Rx.Observable.create(function(c){var f=[{operator:"set",field:"nombre",value:a.nombre},{operator:"set",field:"descripcion",value:a.descripcion},{operator:"set",field:"cedula",value:a.cedula},{operator:"set",field:"telefono",value:a.telefono},{operator:"set",field:"tipoCamion",value:a.tipoCamion},{operator:"set",field:"marca",value:a.marca},{operator:"set",field:"modelo",value:a.modelo},{operator:"set",field:"anio",value:a.anio},{operator:"set",field:"placa",value:a.placa},{operator:"set",field:"color",value:a.color}],g=e.update(b.chofer,d.fromJson(a),{updatedFields:f}).subscribe(function(a){c.onNext(d.toJson(a)),c.onCompleted()},function(a){c.onError(a)},function(){});return function(){g.dispose()}})}}}]),angular.module("easyRuta").controller("transportistaFlotaController",["$scope","transportistaFlotaService","$mdDialog","$mdToast",function(a,b,c,d){a.hideFlotaListHeader=!0;var e=function(){return b.getChoferes()};a.addChofer=function(b){c.show({locals:{chofer:void 0},controller:"addChoferController",templateUrl:"app/components/transportista/flota/addChofer/addChoferView.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0}).then(function(b){
b&&(a.choferes.push(b),a.choferes.sort(function(a,b){return a.nombre>b.nombre}),a.$apply())})},a.editarChofer=function(b,d){var e=a.choferes.find(function(a){return a.id==b});c.show({locals:{chofer:e},controller:"addChoferController",templateUrl:"app/components/transportista/flota/addChofer/addChoferView.html",parent:angular.element(document.body),targetEvent:d,clickOutsideToClose:!0}).then(function(b){b&&a.choferes.sort(function(a,b){return a.nombre>b.nombre})})},a.eliminarChofer=function(e,f){var g=a.choferes.find(function(a){return a.id==e}),h=c.confirm().title("Confirmar").textContent("Estas seguro de querer eliminar este transportista, esta accion es irreversible.").targetEvent(f).ok("Si estoy seguro").cancel("Cancelar");c.show(h).then(function(){b.eliminarChofer(g).subscribe(function(b){a.choferes.splice(a.choferes.indexOf(b),1),a.choferes.sort(function(a,b){return a.nombre>b.nombre})},function(a){console.dir(a),d.show(d.simple().textContent("Ooops!!! parece que estmos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left ").hideDelay(5e3))},function(){})},function(){})},e().subscribe(function(b){a.choferes=b,a.choferes.sort(function(a,b){return a.nombre>b.nombre}),a.$apply()},function(a){119==err.code?($location.path("/home"),$location.replace()):(console.dir(a),d.show(d.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)),c.hide())},function(){})}]),angular.module("easyRuta").service("transportistaFlotaService",["collectionsEnum","choferModel","dataService",function(b,c,d){return{getChoferes:function(){return Rx.Observable.create(function(e){var f=d.getAll(b.chofer,{filters:[{type:"and",operator:"!=",field:"deleted",value:!0}],includes:["transportista"]}).subscribe(function(a){e.onNext(a.map(function(a){return c.toJson(a,[{field:"transportista"}])})),e.onCompleted()},function(b){e.onError(b),i==a.length-1&&e.onCompleted()},function(){});return function(){f.dispose()}})},eliminarChofer:function(a){return Rx.Observable.create(function(e){var f=[{operator:"set",field:"deleted",value:!0}],g=d.update(b.chofer,c.fromJson(a),{updatedFields:f}).subscribe(function(a){e.onNext(c.toJson(a)),e.onCompleted()},function(a){e.onError(a)},function(){});return function(){g.dispose()}})}}}]),angular.module("easyRuta").controller("transportistaPedidosController",["$rootScope","$scope","uiEventsEnum","uiContextEnum","transportistaPedidosService","pedidoEstadosEnum","$mdDialog","pedidoEstadosEnum","realtimeChannels","$mdToast","$location",function(a,b,c,d,e,f,g,f,h,i,j){b.pedidosPendientes=[],b.pedidosEnProceso=[],b.pedidosCompletados=[],b.selectedTabIndex=0;var k=function(){e.getPedidos().subscribe(function(a){a=a.map(function(a){if(a.donacion)a.cssClass="pedido-donacion";else switch(a.estado){case f.pendiente:a.cssClass="pedido-pendientes";break;case f.activo:a.cssClass="pedido-activos";break;case f.enCurso:a.cssClass="pedido-en-curso";break;case f.finalizado:a.cssClass="pedido-completados"}return a}),b.pedidosPendientes=a.filter(function(a){return a.estado==f.pendiente}),b.pedidosEnProceso=a.filter(function(a){return a.estado==f.activo||a.estado==f.enCurso}),b.pedidosCompletados=a.filter(function(a){return a.estado==f.finalizado}),b.$apply()},function(a){console.dir(a),119==a.code?(j.path("/home"),j.replace()):i.show(i.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3))},function(){})},l=function(a,c,d,h){g.show({locals:{text:d},controller:"progressViewController",templateUrl:"app/components/shared/progressIndicator/progressIndicatorView.html",parent:angular.element(document.body),targetEvent:h,clickOutsideToClose:!1}),e.actualizarViaje(a,c).subscribe(function(d){g.hide(),c==f.enCurso&&(b.pedidosEnProceso.splice(b.pedidosEnProceso.indexOf(a),1),b.pedidosEnProceso.push(d),b.pedidosEnProceso.sort(function(a,b){return a.createdAt<b.createdAt})),c==f.finalizado&&(b.pedidosEnProceso.splice(b.pedidosEnProceso.indexOf(a),1),b.pedidosCompletados.push(d),b.pedidosCompletados.sort(function(a,b){return a.createdAt<b.createdAt}))},function(a){console.dir(a),i.show(i.simple().textContent("Ooops!!! parece que estamos experimentando problemas en nuestro servidores por favor contacte a soporte.").position("top left").hideDelay(5e3)),g.hide()},function(){})};b.setTransportista=function(a,c){var d=b.pedidosPendientes.find(function(b){return b.id==a});g.show({locals:{pedido:d},controller:"setTransportistaController",templateUrl:"app/components/shared/pedidos/setTransportista/setTransportistaView.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(a){if(a){var c=b.pedidosPendientes.find(function(b){return b.id==a.id}),d=b.pedidosPendientes.indexOf(c);b.pedidosPendientes.splice(d,1),b.pedidosEnProceso.push(a),b.pedidosEnProceso.sort(function(a,b){return a.createdAt<b.createdAt})}})},b.openMenu=function(a,b){a(b)},b.iniciarViaje=function(a,c){var d=b.pedidosEnProceso.find(function(b){return b.id==a});l(d,f.enCurso,"Inciando Viaje...",c)},b.finalizarViaje=function(a,c){var d=b.pedidosEnProceso.find(function(b){return b.id==a});l(d,f.finalizado,"Finalizando Viaje...",c)},k(),b.$on(h.pedidoCreado,function(a,b){k()}),b.$on(h.pedidoAsignado,function(a,b){k()}),b.$on(h.pedidoCancelado,function(a,b){k()})}]),angular.module("easyRuta").service("transportistaPedidosService",["collectionsEnum","dataService","pedidoModel","pedidoEstadosEnum","realtimeService","realtimeChannels","choferModel","choferEstadosEnum",function(a,b,c,d,e,f,g,h){return{getPedidos:function(){return Rx.Observable.create(function(d){var e=b.getAll(a.pedido,{filters:[{type:"and",operator:"=",field:"plantilla",value:void 0}],includes:["proveedorCarga","transportista","chofer"]}).subscribe(function(a){d.onNext(a.map(function(a){return c.toJson(a,[{field:"proveedorCarga"},{field:"transportista"},{field:"chofer"}])})),d.onCompleted()},function(a){d.onError(a)},function(){});return function(){e.dispose()}})},actualizarViaje:function(i,j){var k=[{operator:"set",field:"estado",value:j}];return j==d.enCurso?k.push({operator:"set",field:"horaInicio",value:new Date}):j==d.finalizado&&k.push({operator:"set",field:"horaFinalizacion",value:new Date}),Rx.Observable.create(function(l){var m=b.update(a.pedido,c.fromJson(i),{updatedFields:k}).flatMap(function(c){var e=i.chofer;return i=c,j==d.finalizado?b.update(a.chofer,g.fromJson(e),{updatedFields:[{operator:"set",field:"estado",value:h.disponible}]}):Rx.Observable.just(void 0)}).subscribe(function(a){j==d.enCurso?e.publish(f.pedidoIniciado,{id:i.id}):j==d.finalizado&&e.publish(f.pedidoFinalizado,{id:i.id}),l.onNext(c.toJson(i,[{field:"proveedorCarga"},{field:"transportista"},{field:"chofer"}])),l.onCompleted()},function(a){l.onError(a)},function(){});return function(){m.dispose()}})}}}]),angular.module("easyRuta").directive("ezChoferes",function(){return{restrict:"E",templateUrl:"app/directives/choferes/ez-choferes.html"}}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;angular.module("easyRuta").controller("AgregarPedidoController",function(f,g,h,i){a=this,b=f,c=g,d=h,e=i,a.Agregar=l,a.GuardarComoPlantilla=m,a.Limpiar=n,a.TipoTransporteSeleccionado=o,a.proveedor_seleccionado=p,a.PlantillaSelected=q,a.DeletePlantilla=r,a.ToggleForm=s,a.seleccionar_transportista=t,j()}).controller("AgregarPedidoModalController",function(a,b){g=this,h=a,i=b,g.guardar=u,g.cancelar=v,k()}),j=function(){e.get_plantillas(B),e.get_ciudades(C),c.$on("presense_"+b.channels.new_pedidos,K),a.availableTransportistas=0,a.open=!1,a.minDate=new Date,a.isDespachador=!1,x(),w()},k=function(){g.plantilla=""},l=function(b){f=b,f.$valid&&(a.data.Plantilla="",a.data.Estado="Pendiente",z(G))},m=function(b){if(f=b,f.$valid){var e=d.open({animation:c.animationsEnabled,templateUrl:"PlantillaModal.html",controller:"AgregarPedidoModalController as agrPedModalCtlr"});e.result.then(function(b){a.data.Plantilla=b,a.data.HoraCarga=null,a.data.HoraEntrega=null,a.data.Estado="Plantilla",a.data.Transportista=null,z(H)},function(){console.log("Modal canceled.")})}},n=function(a){f=a,w()},o=function(b){a.data.Transportista=null,a.data.TipoTransporte=b;var c=null;a.data.Proveedor&&""!=a.data.Proveedor&&a.proveedores.forEach(function(b,d,e){(b.id=a.data.Proveedor)&&(c=b.data)}),e.get_transpostistas_despachador(c,!0,a.data.TipoTransporte,D)},p=function(){a.data.Transportista=null;var b=null;a.data.Proveedor&&""!=a.data.Proveedor&&a.proveedores.forEach(function(c,d,e){(c.id=a.data.Proveedor)&&(b=c.data)}),e.get_transpostistas_despachador(b,!0,a.data.TipoTransporte,D)},q=function(a){e.get_plantilla(a,I)},r=function(a){e.delete_plantilla(a,J)},s=function(){$("#agregarPedido").hasClass("panel-primary")?($("#agregarPedido").removeClass("panel-primary"),$("#agregarPedido").addClass("panel-default"),$("#inputCiudadOrigen").focus(),a.open=!0):($("#agregarPedido").removeClass("panel-default"),$("#agregarPedido").addClass("panel-primary"),a.open=!1)},t=function(b){a.data.Transportista=b},u=function(){i.close(g.plantilla)},v=function(){i.dismiss("cancel")},w=function(){a.copias=1,a.data={Plantilla:"",CiudadOrigen:"",DireccionOrigen:"",CiudadDestino:"",DireccionDestino:"",HoraCarga:new Date,HoraEntrega:new Date,Producto:"",Valor:0,PesoDesde:0,PesoHasta:0,TipoTransporte:"furgon",CajaRefrigerada:!1,Transportista:null},f&&f.$setPristine()},x=function(){c.horaMaxCargaOpen=function(a){c.horaMaxCargaStatus.opened=!0},c.horaMaxCargaStatus={opened:!1},c.horaMaxDescargaOpen=function(a){c.horaMaxDescargaStatus.opened=!0},c.horaMaxDescargaStatus={opened:!1}},y=function(){e.get_active_transportistas(E)},z=function(b){A=b;var c=null;a.data.Transportista&&(c=a.data.Transportista.object),e.guardar_pedidos(a.data,c,F)},B=function(d,f){d||(a.plantillas=f,c.$apply()),b.despachador&&(a.isDespachador=!0,e.get_transpostistas_despachador(null,!0,a.data.TipoTransporte,D))},C=function(b,d){b||(a.ciudades=d,c.$apply())},D=function(b,d){b||(a.transportistas=d,c.$apply())},E=function(b){a.availableTransportistas=b,c.$apply()},F=function(a,b){A(a,b)},G=function(b,c){b||($("#agregarPedidBody").collapse("hide"),$("#agregarPedido").removeClass("panel-default"),$("#agregarPedido").addClass("panel-primary"),a.open=!1,w())},H=function(b,d){b||(a.plantillas.push({id:d[0].id,plantilla:d[0].get("Plantilla")}),c.$apply())},I=function(b,d){d&&(a.data={Plantilla:a.plantilla,CiudadOrigen:d.get("CiudadOrigen").id,DireccionOrigen:d.get("DireccionOrigen"),CiudadDestino:d.get("CiudadDestino").id,DireccionDestino:d.get("DireccionDestino"),HoraCarga:d.get("HoraCarga"),HoraEntrega:d.get("HoraEntrega"),Producto:d.get("Producto"),Valor:d.get("Valor"),PesoDesde:d.get("PesoDesde"),PesoHasta:d.get("PesoHasta"),TipoTransporte:d.get("TipoTransporte"),CajaRefrigerada:d.get("CajaRefrigerada")},d.get("Proveedor")&&d.get("Proveedor").id,c.$apply())},J=function(b,d){if(!b){var e;a.plantillas.forEach(function(a,b,c){(a.id=id)&&(e=b)}),e&&(a.plantillas.splice(e,1),c.$apply())}},K=function(a,b){y()}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;angular.module("easyRuta").controller("MasterPageController",function(n,o,p,q,r,s){a=this,b=n,c=o,d=p,e=q,f=r,g=s,a.Inicio=function(){i()},a.toggleLogin=function(a){l(a)},a.Logout=function(){j()},a.scrollTo=function(a){k(a)},a.showNotifications=function(){m()},h()}),h=function(){l(!1),Parse.User.current()&&(f.get_saldo(n),f.get_notifications_count(o)),c.$on(b.channels.pedido_confirmado,p),c.$on(b.channels.pedido_confirmado_proveedor,q),c.$on(b.channels.pedido_cancelado,r),c.$on(b.channels.nueva_notificacion,s),c.$on(b.channels.clear_notifications,t)},i=function(){b.cliente&&(d.location="/#/inicioClientes"),b.proveedor&&(d.location="/#/inicioProveedores")},j=function(){b.loggedInRole=void 0,b.proveedor=void 0,b.cliente=void 0,Parse.User.logOut(),d.location.href="/"},k=function(a){$("html, body").animate({scrollTop:$("#"+a).offset().top},2e3)},l=function(a){a?(k("content0"),$("#login").show()):$("#login").hide()},m=function(){e.open({animation:c.animationsEnabled,templateUrl:"notifications_center.html",controller:"notifications_center_controller as ctlr"})},n=function(d,e){d||(a.showSaldo=!1,a.Saldo=0,"proveedor"==b.loggedInRole.getName()&&(a.showSaldo=!0,a.Saldo=g.formatCurrency(e)),c.$apply())},o=function(b,d){a.notificationsCount=d,c.$apply()},p=function(a){f.get_saldo(n)},q=function(a){f.get_saldo(n)},r=function(a){f.get_saldo(n)},s=function(a){f.get_notifications_count(o)},t=function(a){f.get_notifications_count(o)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;angular.module("easyRuta").controller("PedidosActivosController",function(k,l,m,n,o){a=this,b=k,c=l,d=m,e=n,f=o,a.verDetalle=h,a.iniciar=i,a.cancelar=j,g()}),g=function(){f.get_pedidos_activos(k),c.$on(b.channels.new_pedidos,n),c.$on(b.channels.pedido_confirmado,o),c.$on(b.channels.pedido_confirmado_proveedor,p),c.$on(b.channels.pedido_cancelado,q),c.$on(b.channels.pedido_cancelado_transportista,r),c.$on(b.channels.pedido_iniciado,s),c.$on(b.channels.pedido_cancelado_confirmado_proveedor,t)},h=function(a){d.path("/detallePedido/"+a.id)},i=function(a){f.iniciar_pedido(a,m)},j=function(a){c.confirm_message="Esta seguro de cancelar este pedido?";var b=e.open({animation:c.animationsEnabled,templateUrl:"confirm_dialog.html",controller:"ConfirmDialogController as ctlr",scope:c});b.result.then(function(b){f.cancelar_pedido(a,l)},function(){console.log("Modal canceled.")})},k=function(d,e){a.isProveedor=!1,b.proveedor&&(a.isProveedor=!0),a.isDespachador=!1,b.despachador&&(a.isDespachador=!0),a.pedidos=e,c.$apply()},m=function(a){f.get_pedidos_activos(k)},l=function(a,b){a||f.get_pedidos_activos(k)},n=function(a){f.get_pedidos_activos(k)},o=function(a){f.get_pedidos_activos(k)},p=function(a){f.get_pedidos_activos(k)},q=function(a){f.get_pedidos_activos(k)},r=function(a){f.get_pedidos_activos(k)},s=function(a){f.get_pedidos_activos(k)},t=function(a){f.get_pedidos_activos(k)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k;angular.module("easyRuta").controller("PedidosCompletadosController",function(j,k,l,m,n){a=this,b=j,c=k,d=l,e=m,f=n,a.verDetalle=h,a.calificar=i,g()}),g=function(){f.get_pedidos_completados(j),c.$on(b.channels.pedido_completado,k)},h=function(a){d.path("/detallePedido/"+a.id)},i=function(){var a=e.open({animation:c.animationsEnabled,templateUrl:"rateTransportistaModal.html",controller:"RateTransportistaModalController as ctlr"});a.result.then(function(){console.log("return from modal"),f.get_pedidos_completados(j)},function(){console.log("modal canceled")})},j=function(d,e){a.isProveedor=!1,b.proveedor&&(a.isProveedor=!0),a.isDespachador=!1,b.despachador&&(a.isDespachador=!0),a.pedidos=e,c.$apply()},k=function(a){f.get_pedidos_completados(j)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;angular.module("easyRuta").controller("PedidosEnCursoController",function(i,j,k,l,m){a=this,b=i,c=j,d=k,e=m,a.verDetalle=g,a.finalizar=h,f()}),f=function(){e.get_pedidos_en_curso(i),c.$on(b.channels.pedido_iniciado,k),c.$on(b.channels.pedido_completado,l),c.$on(b.channels.pedido_cancelado_confirmado_proveedor,m),c.$on(b.channels.pedido_cancelado_confirmado_transportista,n),c.$on(b.channels.pedido_cancelado,o),c.$on(b.channels.pedido_cancelado_transportista,p),a.isProveedor=!1,b.proveedor&&(a.isProveedor=!0)},g=function(a){d.path("/detallePedido/"+a.id)},h=function(a){e.finalizar_pedido(a,j)},i=function(d,e){a.isProveedor=!1,b.proveedor&&(a.isProveedor=!0),a.isDespachador=!1,b.despachador&&(a.isDespachador=!0),a.pedidos=e,c.$apply()},j=function(a,b){a||e.get_pedidos_en_curso(i)},k=function(a){e.get_pedidos_en_curso(i)},l=function(a){e.get_pedidos_en_curso(i)},m=function(a){e.get_pedidos_en_curso(i)},n=function(a){e.get_pedidos_en_curso(i)},o=function(a){e.get_pedidos_en_curso(i)},p=function(a){e.get_pedidos_en_curso(i)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;angular.module("easyRuta").controller("PedidosPendientesController",function(k,l,m,n,o,p){a=this,b=k,c=l,d=m,e=n,f=o,g=p,a.verDetalle=i,a.cancelar=j,h()}),h=function(){g.get_pedidos_pendientes(k),c.$on(b.channels.new_pedidos,n),c.$on(b.channels.pedido_cancelado,o),c.$on(b.channels.pedido_completado,p),c.$on(b.channels.transportista_habilitado,q),c.$on("$destroy",function(){a.timerInterval&&e.cancel(a.timerInterval)})},i=function(a){d.path("/detallePedido/"+a.id)},j=function(a){c.confirm_message="Esta seguro de cancelar este pedido?";var b=f.open({animation:c.animationsEnabled,templateUrl:"confirm_dialog.html",controller:"ConfirmDialogController as ctlr",scope:c});b.result.then(function(b){g.cancelar_pedido(a,m)},function(){console.log("Modal canceled.")})},k=function(b,d){b||(a.pedidos=d,a.pedidosPorConfirmar=0,a.pedidosPorConfirmarProveedor=0,d&&d.forEach(function(b,c,d){"PendienteConfirmacion"==b.estado&&(a.pedidosPorConfirmar+=1),"PendienteConfirmacionProveedor"==b.estado&&(a.pedidosPorConfirmarProveedor+=1)}),c.$apply())},l=function(a,b){a||g.get_pedidos_pendientes(k)},m=function(a,b){a||g.get_pedidos_pendientes(k)},n=function(a){g.get_pedidos_pendientes(k)},o=function(a){g.get_pedidos_pendientes(k)},p=function(a){g.get_pedidos_pendientes(k)},q=function(a){g.get_pedidos_pendientes(k)},r=function(){a.pedidos&&!a.timerInterval&&(a.timerInterval=e(function(){a.pedidos&&a.pedidos.length>0&&a.pedidos.forEach(function(a,b,c){"PendienteConfirmacion"!=a.estado&&"PendienteConfirmacionProveedor"!=a.estado||(a.timer.minute>0||a.timer.second>1?(a.timer.second>0?a.timer.second-=1:a.timer.minute>0&&(a.timer.minute-=1,a.timer.second=59),a.timer.minute>=10?a.timer.value=a.timer.minute:a.timer.value="0"+a.timer.minute,a.timer.value+=":",a.timer.second>=10?a.timer.value+=a.timer.second:a.timer.value+="0"+a.timer.second):g.timeout_pedido(a,l))})},1e3))}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;angular.module("easyRuta").controller("TransportistasProveedorController",function(g,h,i,j){a=this,b=g,c=h,d=i,e=j,a.AgregarTransportista=function(){d.path("/detalleTransportista/")},a.DetalleTransportista=function(a){d.path("/detalleTransportista/"+a.id)},f()}),f=function(){e.check_context_initialization(g),c.$on(b.channels.new_pedidos,i),c.$on(b.channels.pedido_tomado,j),c.$on(b.channels.pedido_rechazado,k),c.$on(b.channels.pedido_confirmado_proveedor,l),c.$on(b.channels.pedido_completado,m),c.$on(b.channels.pedido_cancelado_confirmado,n),c.$on(b.channels.pedido_cancelado_confirmado_proveedor,o),c.$on(b.channels.pedido_cancelado,p),c.$on(b.channels.pedido_cancelado_proveedor,q),c.$on(b.channels.transportista_habilitado,r)},g=function(c,d){a.isDespachador=!1,b.despachador&&(a.isDespachador=!0,e.get_transpostistas_despachador(null,!1,null,h)),a.isProveedor=!1,b.proveedor&&(a.isProveedor=!0,e.get_transportistas_proveedor(h))},h=function(b,d){b||(a.transportistas=d,c.$apply())},i=function(a){e.get_transportistas_proveedor(h)},j=function(a){e.get_transportistas_proveedor(h)},k=function(a){e.get_transportistas_proveedor(h)},l=function(a){e.get_transportistas_proveedor(h)},m=function(a){e.get_transportistas_proveedor(h)},n=function(a){e.get_transportistas_proveedor(h)},o=function(a){e.get_transportistas_proveedor(h)},p=function(a){e.get_transportistas_proveedor(h)},q=function(a){e.get_transportistas_proveedor(h)},r=function(a){e.get_transportistas_proveedor(h)}}(),function(){var a,b,c,d,e,f,g,h,i,j;angular.module("easyRuta").controller("RateTransportistaModalController",function(i,j,k,l){a=this,b=i,c=j,d=k,e=l,a.ok=g,a.cancel=h,f()}),f=function(){e.get_pedidos_completados(i)},g=function(){e.save_all(a.pedidos,j)},h=function(){c.dismiss("cancel")},i=function(c,d){c||(a.pedidos=d,b.$apply())},j=function(a,b){a||c.close()}}(),function(){var a,b,c,d,e,f;angular.module("easyRuta").controller("ConfirmDialogController",function(g,h){a=this,b=g,c=h,a.confirmar=e,a.cancelar=f,d()}),d=function(){a.Message=b.confirm_message},e=function(){c.close("ok")},f=function(){c.dismiss("cancel")}}(),function(){angular.module("easyRuta").controller("inicioDespachadoresController",function(){console.log("inicio despachadores controller")})}(),function(){var a,b,c,d,e,f,g;angular.module("easyRuta").controller("notifications_center_controller",function(g,h,i){a=this,b=g,c=h,d=i,a.cancelar=f,e()}),e=function(){d.get_notifications(g)},f=function(){c.dismiss("cancel")},g=function(c,d){a.notifications=d,b.$apply()}}(),function(){angular.module("easyRuta").controller("RegisterController",function(){this.user={email:"",password:"",confirmedPassword:""},this.Register=function(){var a=new Parse.User;a.set("username",this.user.email),a.set("password",this.user.password),a.set("email",this.user.email),a.signUp(null,{success:function(a){console.log("Success")},error:function(a,b){console.dir(a),console.dir(b),console.log("Fail")}})}})}(),function(){var a,b,c,d,e,f,g,h;angular.module("easyRuta").controller("DetallePedidoController",function(h,i,j,k,l){a=this,b=h,c=i,d=j,e=k,f=l,g()}),g=function(){a.id=c.id,e.get_pedido(a.id,h),d.map={center:{latitude:-1.569363,longitude:-78.705796},zoom:7},d.polylines=[]},h=function(b,c){b||(a.pedido=c,f.then(function(){d.polylines=a.pedido.locations}),d.$apply())}}(),function(){var a,b,c,d,e,f,g,h;angular.module("easyRuta").controller("historicoController",function(h,i,j,k){a=this,b=h,c=i,d=j,e=k,a.verDetalle=g,f()}),f=function(){e.get_historico_pedidos(h)},g=function(a){d.path("/detallePedido/"+a)},h=function(b,d){b||(a.pedidos=d,c.$apply())}}(),function(){angular.module("easyRuta").controller("inicioClientesController",function(){console.log("inicio clientes controller")})}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l;angular.module("easyRuta").controller("perfilController",function(i,j,k,l){a=this,b=i,c=j,d=k,e=l,a.Save=g,a.LoadImage=h,f()}),f=function(){$("#image").bind("change",a.LoadImage),e.get_cliente(k)},g=function(){$("#btnSave").prop("disabled",!0),$("#btnSave").html("Guardando..."),e.save(a.object,a.selectedImage,i)},h=function(b){var d=b.target.files||b.dataTransfer.files,e=new FileReader;e.onload=function(b){a.object.photo=b.target.result,c.$apply()},e.readAsDataURL(d[0]),a.selectedImage=d[0]},i=function(a,b){a?($("#btnSave").prop("disabled",!1),$("#btnSave").html("Guardar")):d.history.back()},j=function(a,b){!a&&b&&l(b)},k=function(a,b){!a&&b&&l(b)},l=function(b){a.object=b,c.$apply()}}(),function(){angular.module("easyRuta").controller("inicioProveedoresController",function(){console.log("inicio proveedores controller")})}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;angular.module("easyRuta").controller("TransportistaEditController",function(p,q,r,s,t){a=this,b=p,c=q,d=r,e=s,f=t,a.save=h,a.cancel=i,a["delete"]=j,a.habilitar=k,a.deshabilitar=l,a.TipoTransporteSeleccionado=m,a.AddAsignacion=n,a.DeleteAsignacion=o,g()}),g=function(){e.id&&f.get_transportista(e.id,p)},h=function(){var b=$("#image")[0];if(b.files.length>0){var c=b.files[0],d=c.name;f.save(a.transportista,d,c,t)}else f.save(a.transportista,null,null,t)},i=function(){d.history.back()},j=function(){f["delete"](a.transportista,u)},k=function(b){b&&a.assignaciones.forEach(function(c,d,e){c.id==b&&(a.cliente=c.object)}),f.habilitar(a.transportista,a.cliente,v)},l=function(){f.deshabilitar(a.transportista,v)},m=function(b){a.transportista.tipoTransporte=b},n=function(b){var c;a.assignaciones_proveedor.forEach(function(a,d,e){a.id==b&&(c=a)}),c&&f.add_asignacion(a.transportista.object,c,x)},o=function(b){var c;a.assignaciones.forEach(function(a,d,e){a.id==b&&(c=a)}),c&&f.delete_asignacion(a.transportista.object,c,y)},p=function(c,d){c||(a.transportista=d,a.isDespachador=!1,b.despachador?(a.isDespachador=!0,a.cliente=b.cliente):f.get_asignaciones_transportista(d.object,r),f.get_viajes_count(d.object,q))},q=function(d,e){a.transportista.estado==b.transportistas_estados.NoDisponible?(a.showHabilitar=!0,a.showDeshabilitar=!1):a.transportista.estado==b.transportistas_estados.EnViaje?(e>0?a.showHabilitar=!1:a.showHabilitar=!0,a.showDeshabilitar=!1):(a.showHabilitar=!1,a.showDeshabilitar=!0),c.$apply()},r=function(c,d){a.assignaciones=d,f.get_asignaciones_proveedor(b.proveedor,s)},s=function(b,d){a.assignaciones_proveedor=[],d.forEach(function(b,c,d){var e=!1;a.assignaciones.forEach(function(a,c,d){b.id==a.id&&(e=!0)}),e||a.assignaciones_proveedor.push(b)}),c.$apply()},t=function(a,b){a||d.history.back()},u=function(a,b){a||d.history.back()},v=function(a,b){a||d.history.back()},w=function(a,b){a||d.history.back()},x=function(b,c){b||f.get_asignaciones_transportista(a.transportista.object,r)},y=function(b,c){b||f.get_asignaciones_transportista(a.transportista.object,r)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;angular.module("easyRuta").factory("agregar_pedido_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={get_plantillas:function(a){f(a)},get_plantilla:function(a,b){h(a,b)},delete_plantilla:function(a,b){g(a,b)},get_ciudades:function(a){i(a)},get_transpostistas_despachador:function(a,b,c,d){j(a,b,c,d)},get_active_transportistas:function(a){k(a)},guardar_pedidos:function(a,b,c){l(a,b,c)}},f=function(a){m=a,c.get_plantillas([],t)},h=function(a,b){n=b,c.get_plantilla([a],u)},g=function(a,b){o=b,c.delete_plantilla([a],v)},i=function(a){p=a,c.get_ciudades([],w)},j=function(b,d,e,f){q=f,c.transportistas_despachador([a.cliente,b,d,e],x)},k=function(a){r=a,b.here_now(y)},l=function(b,d,e){s=e,c.guardar_pedidos([b,a.cliente,d],z)},t=function(a,b,c){if(b)m(b,null);else{var d=new Array;c.forEach(function(a,b,c){d.push({id:a.id,plantilla:a.get("Plantilla")})}),m(null,d)}},u=function(a,b,c){b?n(b,null):n(null,c)},v=function(a,b,c){b?m(b,null):m(null,c)},w=function(a,b,c){if(b)p(b,null);else{var d=new Array;c.forEach(function(a,b,c){d.push({id:a.id,nombre:a.get("Nombre")})}),p(null,d)}},x=function(b,c,e){if(c)q(c,null);else{var f=new Array;if(e.forEach(function(b,c,e){b.get("Estado")==a.transportistas_estados.Disponible&&f.push(d.getTransportistaJson(b))}),f.length>0){f.sort(function(a,b){return a.object.get("EsTercero")!=b.object.get("EsTercero")?a.object.get("EsTercero")?1:-1:a.object.get("HoraDisponible")-b.object.get("HoraDisponible")});var g=0;f=f.filter(function(a){return b[3]==a.tipoTransporte||"furgon_plataforma"==b[3]&&("furgon"==b[3]||"plataforma"==a.tipoTransporte)}).map(function(a){return g++,a.priority=g,a})}q(null,f)}},y=function(a){r(a)},z=function(c,d,e){d?s(d,null):(a.$broadcast("new_pedidos",{}),b.publish(a.channels.new_pedidos,{message:"New Pedido"}),s(null,e))}}(),function(){var a,b,c,d,e,f,g;angular.module("easyRuta").factory("detalle_pedido_viewmodel",function(e,f,g){return a=e,b=f,c=g,d}),d={get_pedido:function(a,b){e(a,b)}},e=function(a,c){f=c,b.get_pedido([a],g)},g=function(b,d,e){if(d)f(d,null);else{var g=c.getJson(e);g.transportista=c.getTransportistaJson(e.get("Transportista")),a.cliente&&g.object.get("Proveedor")&&(g.transportista=c.parseProveedorIntoTransportista(g.transportista,g.object.get("Proveedor"))),f(null,g)}}}(),function(){var a,b,c,d,e,f,g;angular.module("easyRuta").factory("historico_view_model",function(e,f,g){return a=e,b=f,c=g,d}),d={get_historico_pedidos:function(a){e(a)}},e=function(a){f=a,b.get_historico_pedidos([],g)},g=function(b,d,e){if(d)f(d,null);else{var g=new Array;e.forEach(function(b,d,e){var f=c.getJson(b);f.transportista=c.getTransportistaJson(b.get("Transportista")),a.cliente&&f.object.get("Proveedor")&&(f.transportista=c.parseProveedorIntoTransportista(f.transportista,f.object.get("Proveedor"))),g.push(f)}),f(null,g)}}}(),function(){var a,b,c,d,e,f,g,h;angular.module("easyRuta").factory("master_page_viewmodel",function(c){return a=c,b}),b={get_saldo:function(a){c(a)},get_notifications_count:function(a){d(a)}},c=function(b){e=b,a.current_proveedor([],g)},d=function(b){f=b,a.notifications_count([],h)},g=function(a,b,c){b?e(b,null):c&&e(null,c.get("Saldo"))},h=function(a,b,c){b?f(b,0):f(null,c)}}(),function(){var a,b,c,d,e,f,g,h,i;angular.module("easyRuta").factory("notifications_center_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={get_notifications:function(a){f(a)}},f=function(a){g=a,c.get_notifications([],h)},h=function(b,e,f){if(e)g(h,null);else{var h=new Array;f.forEach(function(b,c,e){var f=d.getNotificationJson(b);b.get("Pedido")&&(f.pedido=d.getJson(b.get("Pedido")),b.get("Pedido").get("Transportista")&&(f.pedido.transportista=d.getTransportistaJson(b.get("Pedido").get("Transportista")),a.cliente&&pedido.object.get("Proveedor")&&(f.pedido.transportista=d.parseProveedorIntoTransportista(f.pedido.transportista,f.pedido.object.get("Proveedor"))))),h.push(f)}),g(null,h),c.clear_notifications([],i)}},i=function(c,d,e){d||(b.publish(a.channels.clear_notifications,{id:"cleared:"+e.length}),a.$broadcast(a.channels.clear_notifications,{id:"cleared:"+e.length}))}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;angular.module("easyRuta").factory("pedidos_activos_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={get_pedidos_activos:function(a){f(a)},cancelar_pedido:function(a,b){g(a,b)},iniciar_pedido:function(a,b){h(a,b)}},f=function(a){i=a,c.get_pedidos_activos([],l)},g=function(a,b){j=b,c.cancelar_pedido([a.object],m)},h=function(a,b){k=b,c.iniciar_pedido([a.object],n)},l=function(b,c,e){if(c)i(c,null);else{var f=new Array;e.forEach(function(b,c,e){var g=d.getJson(b);g.transportista=d.getTransportistaJson(b.get("Transportista")),a.cliente&&g.object.get("Proveedor")&&(g.transportista=d.parseProveedorIntoTransportista(g.transportista,g.object.get("Proveedor"))),f.push(g)}),i(null,f)}},m=function(d,e,f){b.publish(a.channels.pedido_cancelado,{id:d[0].id}),a.$broadcast(a.channels.pedido_cancelado,{id:d[0].id}),c.agregar_notification(["Pedido Cancelado",d[0]],o),j(e,f)},n=function(c,d,e){b.publish(a.channels.pedido_iniciado,{id:c[0].id}),a.$broadcast(a.channels.pedido_iniciado,{id:c[0].id}),k(d,e)},o=function(c,d,e){d||b.publish(a.channels.nueva_notificacion,{id:c[1].id})}}(),function(){var a,b,c,d,e,f,g,h;angular.module("easyRuta").factory("pedidos_completados_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={get_pedidos_completados:function(a){f(a)}},f=function(a){g=a,c.get_pedidos_completados([],h)},h=function(b,c,e){if(c)g(c,null);else{var f=new Array;e.forEach(function(b,c,e){var g=d.getJson(b);g.transportista=d.getTransportistaJson(b.get("Transportista")),a.cliente&&g.object.get("Proveedor")&&(g.transportista=d.parseProveedorIntoTransportista(g.transportista,g.object.get("Proveedor"))),f.push(g)}),g(c,f)}}}(),function(){var a,b,c,d,e,f,g,h,i,j,k;angular.module("easyRuta").factory("pedidos_en_curso_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={get_pedidos_en_curso:function(a){f(a)},finalizar_pedido:function(a,b){g(a,b)}},f=function(a){h=a,c.get_pedidos_en_curso([],j)},g=function(a,b){i=b,c.finalizar_pedido([a.object],k)},j=function(b,c,e){if(c)h(c,null);else{var f=new Array;e.forEach(function(b,c,e){var g=d.getJson(b);g.transportista=d.getTransportistaJson(b.get("Transportista")),a.cliente&&g.object.get("Proveedor")&&(g.transportista=d.parseProveedorIntoTransportista(g.transportista,g.object.get("Proveedor"))),f.push(g)}),h(null,f)}},k=function(c,d,e){b.publish(a.channels.pedido_completado,{id:c[0].id}),a.$broadcast(a.channels.pedido_completado,{id:c[0].id}),i(d,e)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;angular.module("easyRuta").factory("pedidos_pendientes_viewmodel",function(e,f,g,i){return a=e,b=f,c=g,d=i,h}),h={get_pedidos_pendientes:function(a){i(a)},confirmar_pedido:function(a,b){j(a,b)},rechazar_pedido:function(a,b){k(a,b)},proveedor_tomar_pedido:function(a,b,c){l(a,b,c)},proveedor_confirmar_pedido:function(a,b,c){m(a,b,c)},proveedor_rechazar_pedido:function(a,b){n(a,b)},timeout_pedido:function(a,b){o(a,b)},cancelar_pedido:function(a,b){p(a,b)},ignorar_pedido:function(a,b){
q(a,b)}},i=function(a){r=a,c.get_pedidos_pendientes(new Array,A)},j=function(a,b){s=b,c.confirmar_pedido([a.object],B)},k=function(a,b){t=b,c.rechazar_pedido([a.object],C)},l=function(b,d,e){u=e,c.proveedor_tomar_pedido([b.object,d.object,a.proveedor],D)},m=function(a,b,d){v=d,c.proveedor_confirmar_pedido([a.object,b.object],E)},n=function(b,d){w=d,c.proveedor_rechazar_pedido([b.object,a.proveedor],F)},o=function(a,b){x=b,c.timeout_pedido([a.object],J)},p=function(a,b){y=b,c.cancelar_pedido([a.object],K)},q=function(b,d){z=d,c.ignorar_pedido([b.object,a.proveedor],L)},A=function(b,h,i){h?r(h,null):(f=i,e=new Array,g=0,i.length>0?i.forEach(function(f,g,h){var i=d.getJson(f);"cliente"==a.loggedInRole.getName()?(f.get("Proveedor")&&(i.proveedor=d.getProveedorJson(f.get("Proveedor"))),f.get("Transportista")?c.transportista_statistics([f.get("Transportista"),i],G):G([null,i],null,null)):"proveedor"==a.loggedInRole.getName()&&(a.proveedor.get("Saldo")-i.object.get("Comision")<a.proveedor.get("SaldoMin")&&(i.valores=i.valores+" - Saldo Insuficiente!!!"),f.get("Estado")==a.pedidos_estados.Pendiente||f.get("Estado")==a.pedidos_estados.PendienteConfirmacionProveedor?c.transportistas_proveedor([f,i],H):f.get("Estado")==a.pedidos_estados.PendienteConfirmacion&&(f.get("Transportista")&&(i.transportista=d.getTransportistaJson(f.get("Transportista"))),e.push(i),I(b,null,null)))}):r(h,null))},G=function(a,b,c){var d=a[1];!b&&c&&(d.transportista={statistics:c}),e.push(d),I(a,null,null)},H=function(b,c,f){var g=b[1];if(g.transportistas=new Array,f.forEach(function(b,c,e){b.get("Estado")==a.transportistas_estados.Disponible&&g.transportistas.push(d.getTransportistaJson(b))}),g.transportistas.length>0){g.transportistas.sort(function(a,b){return a.object.get("EsTercero")!=b.object.get("EsTercero")?a.object.get("EsTercero")?1:-1:a.object.get("HoraDisponible")-b.object.get("HoraDisponible")});var h=0;g.transportistas=g.transportistas.filter(function(a){return g.tipoTransporte==a.tipoTransporte||"furgon_plataforma"==g.tipoTransporte&&("furgon"==a.tipoTransporte||"plataforma"==a.tipoTransporte)}).map(function(a){return h++,a.priority=h,a}),e.push(g)}I(b,null,null)},I=function(a,b,c){g++,g>=f.length&&(e.sort(function(a,b){return a.object.get("createdAt")-b.object.get("createdAt")}),r(null,e))},B=function(c,d,e){a.$broadcast(a.channels.pedido_confirmado,c[0]),b.publish(a.channels.pedido_confirmado,{id:c[0].id}),s(d,null)},C=function(c,d,e){b.publish(a.channels.pedido_rechazado,{id:c[0].id}),t(d,null)},D=function(c,d,e){b.publish(a.channels.pedido_tomado,{id:c[0].id}),u(d,null)},E=function(c,d,e){a.$broadcast(a.channels.pedido_confirmado_proveedor,c[0]),b.publish(a.channels.pedido_confirmado_proveedor,{id:c[0].id}),v(d,null)},F=function(c,d,e){b.publish(a.channels.pedido_rechazado_proveedor,{id:c[0].id}),w(d,null)},J=function(c,d,e){b.publish(a.channels.pedido_timeout,{id:c[0].id}),x(d,null)},K=function(c,d,e){b.publish(a.channels.pedido_cancelado,{id:c[0].id}),y(d,e)},L=function(c,d,e){b.publish(a.channels.pedido_ignorado,{id:c[0].id}),z(d,e)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;angular.module("easyRuta").factory("perfil_viewmodel",function(e,f,g){return a=e,b=f,c=g,d}),d={save:function(a,b,c){e(a,b,c)},get_cliente:function(a){f(a)},get_proveedor:function(a){g(a)}},e=function(c,d,e){h=e,"cliente"==a.loggedInRole.getName()?b.save_cliente([c,d],k):"proveedor"==a.loggedInRole.getName()&&b.save_proveedor([c,d],k)},f=function(a){i=a,b.current_cliente([],l)},g=function(a){j=a,b.current_proveedor([],m)},k=function(a,b,c){b?h(b,null):h(null,c)},l=function(a,b,d){if(b)i(b,null);else{var e=c.getClienteJson(d);i(null,e)}},m=function(a,b,d){if(b)j(b,null);else{var e=c.getProveedorJson(d);j(null,e)}}}(),function(){var a,b,c,d,e,f,g,h,i;angular.module("easyRuta").factory("rate_transportista_modal_viewmodel",function(d,e){return a=d,b=e,c}),c={get_pedidos_completados:function(a){d(a)},save_all:function(a,b){e(a,b)}},d=function(b){f=b,a.get_pedidos_completados_no_calificados([],h)},e=function(b,c){g=c,a.rate_pedidos([b],i)},h=function(a,c,d){if(c)f(c,null);else{var e=new Array;d.forEach(function(a,c,d){var f=b.getJson(a);f.transportista=b.getTransportistaJson(a.get("Transportista")),f.object.get("Proveedor")&&(f.transportista=b.parseProveedorIntoTransportista(f.transportista,f.object.get("Proveedor"))),e.push(f)}),f(c,e)}},i=function(a,b,c){g(b,c)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;angular.module("easyRuta").factory("transportista_edit_viewmodel",function(e,f,g,h){return a=e,b=g,c=h,d}),d={get_transportista:function(a,b){e(a,b)},get_asignaciones_transportista:function(a,b){f(a,b)},get_asignaciones_proveedor:function(a,b){g(a,b)},get_viajes_count:function(a,b){h(a,b)},save:function(a,b,c,d){i(a,b,c,d)},"delete":function(a,b){j(a,b)},habilitar:function(a,b,c){k(a,b,c)},deshabilitar:function(a,b){l(a,b)},add_asignacion:function(a,b,c){m(a,b,c)},delete_asignacion:function(a,b,c){n(a,b,c)}},e=function(a,c){o=c,b.get_transportista([a],y)},f=function(a,c){p=c,b.get_asignaciones_transportista([a],z)},g=function(a,c){q=c,b.get_asignaciones_proveedor([a],A)},h=function(a,c){r=c,b.viajes_en_curso_transportista_count([a],G)},i=function(c,d,e,f){s=f,d&&e?b.save_file([c,d,e],C):b.save_transportista([c,a.proveedor],B)},j=function(a,c){t=c,b.delete_transportista([a.object],D)},k=function(c,d,e){u=e,b.update_estado_transportista([c.object,null,new Date,d,new Date,a.transportistas_estados.Disponible],E)},l=function(c,d){v=d,b.update_estado_transportista([c.object,null,null,null,void 0,a.transportistas_estados.NoDisponible],F)},m=function(a,c,d){w=d,b.add_asignacion_proveedor([a,c],H)},n=function(a,c,d){x=d,b.delete_asignacion_proveedor([a,c],I)},y=function(a,b,d){var e;b||(e=c.getTransportistaJson(d[0])),o(b,e)},z=function(a,b,d){var e=[];b||d.forEach(function(a,b,d){e.push(c.getClienteJson(a))}),p(b,e)},A=function(a,b,d){var e=[];b||d.forEach(function(a,b,d){e.push(c.getClienteJson(a))}),q(b,e)},G=function(a,b,c){var d;b||(d=c),r(b,d)},B=function(a,b,c){s(b,c)},C=function(c,d,e){d||(c[0].object.set("photo",e),b.save_transportista([c[0],a.proveedor],B))},D=function(a,b,c){t(b,c)},E=function(a,b,c){u(b,c)},F=function(a,b,c){v(b,c)},H=function(a,b,c){w(b,c)},I=function(a,b,c){x(b,c)}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;angular.module("easyRuta").factory("transportistas_proveedor_viewmodel",function(f,g,h,i){return a=f,b=g,c=h,d=i,e}),e={check_context_initialization:function(a){f(a)},get_transportistas_proveedor:function(a){g(a)},get_transpostistas_despachador:function(a,b,c,d){h(a,b,c,d)},habilitar_transportista:function(a,b){i(a,b)}},f=function(a){j=a,c.check_context_initialization([],n)},g=function(a){k=a,c.transportistas_proveedor([],o)},h=function(b,d,e,f){l=f,c.transportistas_despachador([a.cliente,b,d,e],p)},n=function(a,b,c){j(b,c)},o=function(b,c,e){var f=e.map(function(b){var c=d.getTransportistaJson(b);return c.estado==a.transportistas_estados.Disponible?(c.checkGlyphicon="glyphicon-ok",c.checkColor="list-item-check-green"):c.estado==a.transportistas_estados.NoDisponible?(c.checkGlyphicon="glyphicon-minus",c.checkColor="list-item-check-red"):c.estado==a.transportistas_estados.EnViaje&&(c.checkGlyphicon="glyphicon-random",c.checkColor="list-item-check-blue"),c});f.sort(function(a,b){return a.object.get("EsTercero")!=b.object.get("EsTercero")?a.object.get("EsTercero")?1:-1:a.object.get("HoraDisponible")-b.object.get("HoraDisponible")}),k(c,f)},p=function(b,c,e){var f=e.map(function(b){var c=d.getTransportistaJson(b);return c.estado==a.transportistas_estados.Disponible?(c.checkGlyphicon="glyphicon-ok",c.checkColor="list-item-check-green"):c.estado==a.transportistas_estados.NoDisponible?(c.checkGlyphicon="glyphicon-minus",c.checkColor="list-item-check-red"):c.estado==a.transportistas_estados.EnViaje&&(c.checkGlyphicon="glyphicon-random",c.checkColor="list-item-check-blue"),c});f.sort(function(a,b){return a.object.get("EsTercero")!=b.object.get("EsTercero")?a.object.get("EsTercero")?1:-1:a.object.get("HoraDisponible")-b.object.get("HoraDisponible")}),l(c,f)},q=function(c,d,e){a.$broadcast(a.channels.transportista_habilitado,c[0]),b.publish(a.channels.transportista_habilitado,{id:c[0].id}),m(d,e)}}(),angular.module("easyRuta").directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"="},link:function(a,b,c,d){a.$watch(function(){var b;return(a.passwordVerify||d.$viewValue)&&(b=a.passwordVerify+"_"+d.$viewValue),b},function(b){b&&d.$parsers.unshift(function(b){var c=a.passwordVerify;return c!==b?void d.$setValidity("passwordVerify",!1):(d.$setValidity("passwordVerify",!0),b)})})}}}),angular.module("easyRuta").directive("ezPedidoActivo",function(){return{restrict:"E",templateUrl:"/app/directives/pedidos/ez-pedido-activo.html"}}),angular.module("easyRuta").directive("ezPedidoCompletado",function(){return{restrict:"E",templateUrl:"/app/directives/pedidos/ez-pedido-completado.html"}}),angular.module("easyRuta").directive("ezPedidoEnCurso",function(){return{restrict:"E",templateUrl:"/app/directives/pedidos/ez-pedido-en-curso.html"}}),angular.module("easyRuta").directive("ezPedidoPendiente",function(){return{restrict:"E",templateUrl:"/app/directives/pedidos/ez-pedido-pendiente.html"}}),angular.module("easyRuta").directive("ezPedidos",function(){return{restrict:"E",templateUrl:"app/directives/pedidos/ez-pedidos.html"}});var Airbrake;angular.module("easyRuta").run([function(){}]).factory("$exceptionHandler",[function(){return function(a,b){console.log(a)}}]),angular.module("easyRuta").factory("brokerModel",["dataService","collectionsEnum",function(a,b){return{toJson:function(a,b){var c={object:a,id:a.id,nombre:a.get("nombre")};return b&&b.forEach(function(a,b,c){}),c},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.broker)),d.set("nombre",c.nombre),d}}}]),angular.module("easyRuta").factory("choferModel",["dataService","collectionsEnum","transportistaModel","brokerModel","proveedorCargaModel",function(a,b,c,d,e){return{toJson:function(a,b){var f={object:a,id:a.id,descripcion:a.get("descripcion"),nombre:a.get("nombre"),cedula:a.get("cedula"),telefono:a.get("telefono"),rating:a.get("rating"),marca:a.get("marca"),modelo:a.get("modelo"),anio:a.get("anio"),placa:a.get("placa"),color:a.get("color"),tipoCamion:a.get("tipoCamion"),estado:a.get("estado"),ciudadDisponible:a.get("ciudadDisponible"),horaDisponible:a.get("horaDisponible"),ciudadesDisponible:a.get("ciudadesDisponible"),deleted:a.get("deleted")},g=a.get("transportista"),h=a.get("broker"),i=a.get("proveedorCarga");return b?b.forEach(function(a,b,j){"transportista"==a.field&&g&&(f.transportista=c.toJson(g,a.includes)),"broker"==a.field&&h&&(f.broker=d.toJson(h,a.includes)),"proveedorCarga"==a.field&&i&&(f.proveedorCarga=e.toJson(i,a.includes))}):(g&&(f.transportista=g.id),h&&(f.broker=h.id),i&&(f.proveedorCarga=i.id)),f},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.chofer)),d.set("descripcion",c.descripcion),d.set("nombre",c.nombre),d.set("cedula",c.cedula),d.set("telefono",c.telefono),d.set("rating",c.rating),d.set("marca",c.marca),d.set("modelo",c.modelo),d.set("anio",c.anio),d.set("placa",c.placa),d.set("color",c.color),d.set("tipoCamion",c.tipoCamion),d.set("estado",c.estado),d.set("ciudadDisponible",c.ciudadDisponible),d.set("horaDisponible",c.horaDisponible),d.set("ciudadesDisponible",c.ciudadesDisponible),d.set("deleted",c.deleted),c.transportista&&c.transportista.object&&d.set("transportista",c.transportista.object),c.broker&&c.broker.object&&d.set("broker",c.broker.object),c.proveedorCarga&&c.proveedorCarga.object&&d.set("proveedorCarga",c.proveedorCarga.object),d}}}]),angular.module("easyRuta").factory("notificacionModel",["dataService","collectionsEnum","pedidoModel",function(a,b,c){return{toJson:function(a,b){var d={object:a,id:a.id,descripcion:a.get("descripcion"),leida:a.get("leida")},e=a.get("pedido");return b?b.forEach(function(a,b,f){"pedido"==a.field&&e&&(d.pedido=c.toJson(e,a.includes))}):e&&(d.pedido=e.id),d},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.notificacion)),d.set("descripcion",c.descripcion),d.set("leida",c.leida),c.pedido.object&&d.set("proveedorCarga",c.pedido.object),d}}}]),angular.module("easyRuta").factory("pedidoModel",["dataService","collectionsEnum","proveedorCargaModel","brokerModel","transportistaModel","choferModel",function(a,b,c,d,e,f){return{toJson:function(a,b){var g={object:a,id:a.id,plantilla:a.get("plantilla"),managedByBroker:a.get("managedByBroker"),estado:a.get("estado"),ciudadOrigen:a.get("ciudadOrigen"),direccionOrigen:a.get("direccionOrigen"),horaCarga:a.get("horaCarga"),ciudadDestino:a.get("ciudadDestino"),direccionDestino:a.get("direccionDestino"),horaEntrega:a.get("horaEntrega"),producto:a.get("producto"),tipoCamion:a.get("tipoCamion"),peso:a.get("peso"),valor:a.get("valor"),valorSinDescuento:a.get("valorSinDescuento"),comision:a.get("comision"),rate:a.get("rate"),horaInicio:a.get("horaInicio"),horaFinalizacion:a.get("horaFinalizacion"),horaCancelacion:a.get("horaCancelacion"),horaAsignacion:a.get("horaAsignacion"),locations:a.get("locations"),donacion:a.get("donacion"),createdAt:a.get("createdAt")};g.locations&&g.locations.length>0&&(g.currentLocation=g.locations[g.locations.length-1].split(","));var h=a.get("proveedorCarga"),i=a.get("broker"),j=a.get("transportista"),k=a.get("chofer");return b?b.forEach(function(a,b,l){"proveedorCarga"==a.field&&h&&(g.proveedorCarga=c.toJson(h,a.includes)),"broker"==a.field&&i&&(g.broker=d.toJson(i,a.includes)),"transportista"==a.field&&j&&(g.transportista=e.toJson(j,a.includes)),"chofer"==a.field&&k&&(g.chofer=f.toJson(k,a.includes))}):(h&&(g.proveedorCarga=h.id),i&&(g.broker=i.id),j&&(g.transportista=j.id),k&&(g.chofer=k.id)),g},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.pedido)),d.set("plantilla",c.plantilla),d.set("managedByBroker",c.managedByBroker),d.set("estado",c.estado),d.set("ciudadOrigen",c.ciudadOrigen),d.set("direccionOrigen",c.direccionOrigen),d.set("horaCarga",c.horaCarga),d.set("ciudadDestino",c.ciudadDestino),d.set("direccionDestino",c.direccionDestino),d.set("horaEntrega",c.horaEntrega),d.set("producto",c.producto),d.set("tipoCamion",c.tipoCamion),d.set("peso",c.peso),d.set("valor",c.valor),d.set("valorSinDescuento",c.valorSinDescuento),d.set("comision",c.comision),d.set("rate",c.rate),d.set("horaInicio",c.horaInicio),d.set("horaFinalizacion",c.horaFinalizacion),d.set("horaCancelacion",c.horaCancelacion),d.set("horaAsignacion",c.horaAsignacion),d.set("donacion",c.donacion),d.set("createdAt",c.createdAt),c.proveedorCarga&&c.proveedorCarga.object&&d.set("proveedorCarga",c.proveedorCarga.object),c.broker&&c.broker.object&&d.set("broker",c.broker.object),c.transportista&&c.transportista.object&&d.set("transportista",c.transportista.object),c.chofer&&c.chofer.object&&d.set("chofer",c.chofer.object),d}}}]),angular.module("easyRuta").factory("proveedorCargaModel",["dataService","collectionsEnum","userModel",function(a,b,c){return{toJson:function(a,b){var d={object:a,id:a.id,nombre:a.get("nombre"),telefono:a.get("telefono"),contacto:a.get("contacto"),asociados:a.get("asociados"),asociadoConTodos:a.get("asociadoConTodos")},e=a.get("user");return b?b.forEach(function(a,b,f){"user"==a.field&&e&&(d.user=c.toJson(e,a.includes))}):e&&(d.user=e.id),d},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.proveedorCarga)),d.set("nombre",c.nombre),d.set("telefono",c.telefono),d.set("contacto",c.contacto),prvoeedorCarga.set("asociados",c.asociados),prvoeedorCarga.set("asociadoConTodos",c.asociadoConTodos),c.user.object&&prvoeedorCarga.set("user",c.user.object),d}}}]),angular.module("easyRuta").factory("proveedorCargaRutasModel",["dataService","collectionsEnum","proveedorCargaModel",function(a,b,c){return{toJson:function(a,b){var d={object:a,id:a.id,ciudadOrigen:a.get("ciudadOrigen"),ciudadDestino:a.get("ciudadDestino"),peso:a.get("peso"),valor:a.get("valor")},e=a.get("proveedorCarga");return b?b.forEach(function(a,b,f){"proveedorCarga"==a.field&&e&&(d.proveedorCarga=c.toJson(e,a.includes))}):e&&(d.proveedorCarga=e.id),d},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.proveedorCargaRutas)),d.set("ciudadOrigen",c.ciudadOrigen),d.set("ciudadDestino",c.ciudadDestino),d.set("peso",c.peso),d.set("valor",c.valor),c.proveedorCarga.object&&d.set("proveedorCarga",c.proveedorCarga.object),d}}}]),angular.module("easyRuta").factory("transportistaModel",["dataService","collectionsEnum","userModel",function(a,b,c){return{toJson:function(a,b){var d={object:a,id:a.id,nombre:a.get("nombre"),saldo:a.get("saldo"),saldoMin:a.get("saldoMin")},e=a.get("user");return b?b.forEach(function(a,b,f){"user"==a.field&&e&&(d.user=c.toJson(e,a.includes))}):e&&(d.user=e.id),d},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.transportista)),d.set("nombre",c.nombre),d.set("saldo",c.saldo),d.set("saldoMin",c.saldoMin),c.user.object&&d.set("user",c.user.object),d}}}]),angular.module("easyRuta").factory("transportistaRutasModel",["dataService","collectionsEnum","transportistaModel",function(a,b,c){return{toJson:function(a,b){var d={object:a,id:a.id,ciudadOrigen:a.get("ciudadOrigen"),ciudadDestino:a.get("ciudadDestino"),peso:a.get("peso"),valor:a.get("valor"),descuento:a.get("descuento")},e=a.get("transportista");return b?b.forEach(function(a,b,f){"transportista"==a.field&&e&&(d.transportista=c.toJson(e,a.includes))}):e&&(d.transportista=e.id),d},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.transportistaRutas)),d.set("ciudadOrigen",c.ciudadOrigen),d.set("ciudadDestino",c.ciudadDestino),d.set("peso",c.peso),d.set("valor",c.valor),d.set("descuento",c.descuento),c.transportista.object&&d.set("transportista",c.transportista.object),d}}}]),angular.module("easyRuta").factory("userModel",["dataService","collectionsEnum",function(a,b){return{toJson:function(a,b){var c={object:a,id:a.id,username:a.get("username"),email:a.get("email")};return b&&b.forEach(function(a,b,c){}),c},fromJson:function(c){var d=c.object;return d||(d=a.createCollection(b.user)),d.set("username",c.username),d.set("email",c.email),d}}}]),angular.module("easyRuta").filter("capitalizeFirst",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),angular.module("easyRuta").filter("parsePeso",function(){return function(a){return a.replace("_"," a ")+" toneladas"}}),angular.module("easyRuta").filter("tipoCamionList",function(){return function(a){return a.join(", ")}});